"use strict";function _slicedToArray(t,n){return _arrayWithHoles(t)||_iterableToArrayLimit(t,n)||_unsupportedIterableToArray(t,n)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(t,n){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var e=[],o=!0,a=!1,r=void 0;try{for(var i,s=t[Symbol.iterator]();!(o=(i=s.next()).done)&&(e.push(i.value),!n||e.length!==n);o=!0);}catch(t){a=!0,r=t}finally{try{o||null==s.return||s.return()}finally{if(a)throw r}}return e}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,n){if(t){if("string"==typeof t)return _arrayLikeToArray(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?_arrayLikeToArray(t,n):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,o=new Array(n);e<n;e++)o[e]=t[e];return o}function init(){console.log(window.variables),checkValid()}function checkValid(){var t=$(".btn-add-pool"),n=$(".btn-update-stpd"),e=$(".btn-update-msa"),o=$(".btn-run-function"),a=window.variables.ACCOUNT;if(!a)return $(t).html('<button class="btn btn-big js-popup-open" href="#connect_wallet">Connect Wallet</button>'),$(n).html('<button class="btn btn-big js-popup-open" href="#connect_wallet">Connect Wallet</button>'),$(e).html('<button class="btn btn-big js-popup-open" href="#connect_wallet">Connect Wallet</button>'),void $(o).html('<button class="btn btn-big js-popup-open" href="#connect_wallet">Connect Wallet</button>');$(t).html('<button class="btn btn-big" href="#add_pool">Add Pool</button>'),$(t).children().click(onAddPool),$(n).html('<button class="btn btn-big" href="#update_stpd">Update</button>'),$(n).children().click(onUpdateStpd),$(e).html('<button class="btn btn-big" href="#update_msa">Update</button>'),$(e).children().click(onUpdateMsa),$(o).html('<button class="btn btn-big" href="#run_function">Run Function</button>'),$(o).children().click(onRunFunction),a&&Promise.all([getPools()]).then(function(t){var n=_slicedToArray(t,1)[0],e="",o="";n.forEach(function(t){0<t.maxStake?e+=t.id+", ":o+=t.id+", "}),$(".admin-factory-stpd-form__pools-available").html("<p>Available Pools : </p><p> ".concat(e,"</p>")),$(".admin-factory-stpd-form__pools-disabled").html("<p>Disabled Pools : </p><p> ".concat(o,"</p>")),$(".admin-factory-msa-form__pools-available").html("<p>Available Pools : </p><p> ".concat(e,"</p>")),$(".admin-factory-msa-form__pools-disabled").html("<p>Disabled Pools : </p><p> ".concat(o,"</p>"))}).catch(console.log)}function onAddPool(){var t=window.variables,n=t.ACCOUNT,e=t.FACTORY_CONTRACT,o=$(".admin-factory-form__input-row[data-input='tokenAddress']"),a=$(".admin-factory-form__input-row[data-input='amount']"),r=$(".admin-factory-form__input-row[data-input='maxAmount']"),i=o.find("input").val(),s=a.find("input").val(),c=r.find("input").val();i?toChecksumAddress(i)?s?s<0?$(".admin-factory-form__notice").html("Please enter the valid reward amount."):c?c<0?$(".admin-factory-form__notice").html("Please enter the valid max stake amount."):($(".admin-factory-form__notice").html(""),send(e.methods.add)(i,new BigNumber(s).times(1e18).toString(10),new BigNumber(c).times(1e18).toString(10),{from:n}).send().on("transactionHash",function(t){handleTransactionSuccess(t),services.push({text:"Created new pool",hash:t})}).on("receipt",function(t){services.update(t)}).on("error",function(t,n){console.log("error :>> ",t),handleTransactionError(),n&&services.update(n)})):$(".admin-factory-form__notice").html("Please enter the max stake amount."):$(".admin-factory-form__notice").html("Please enter the reward amount."):$(".admin-factory-form__notice").html("Please enter valid token address."):$(".admin-factory-form__notice").html("Please enter token address.")}function onUpdateStpd(){var t=window.variables,n=t.ACCOUNT,e=t.FACTORY_CONTRACT,o=$(".admin-factory-form__input-row[data-input='poolid']"),a=$(".admin-factory-form__input-row[data-input='seconfaryTokenPerDay']"),r=o.find("input").val(),i=a.find("input").val();r?r<0?$(".admin-factory-stpd-form__notice").html("Please enter the valid pool id."):i?i<0?$(".admin-factory-stpd-form__notice").html("Please enter the valid reward amount."):($(".admin-factory-stpd-form__notice").html(""),send(e.methods.setSecondaryTokensPerDay)(new BigNumber(r).toString(10),new BigNumber(i).times(1e18).toString(10),{from:n}).send().on("transactionHash",function(t){handleTransactionSuccess(t),services.push({text:"Updated secondaryTokensPerDay to ".concat(i),hash:t})}).on("receipt",function(t){services.update(t)}).on("error",function(t,n){console.log("error :>> ",t),handleTransactionError(),n&&services.update(n)})):$(".admin-factory-stpd-form__notice").html("Please enter the reward amount."):$(".admin-factory-stpd-form__notice").html("Please enter the pool id.")}function onUpdateMsa(){var t=window.variables,n=t.ACCOUNT,e=t.FACTORY_CONTRACT,o=$(".admin-factory-form__input-row[data-input='pid']"),a=$(".admin-factory-form__input-row[data-input='maxStake']"),r=o.find("input").val(),i=a.find("input").val();r?r<0?$(".admin-factory-msa-form__notice").html("Please enter the valid pool id."):i?i<0?$(".admin-factory-msa-form__notice").html("Please enter the valid max stake amount."):($(".admin-factory-msa-form__notice").html(""),send(e.methods.setMaxStake)(new BigNumber(r).toString(10),new BigNumber(i).times(1e18).toString(10),{from:n}).send().on("transactionHash",function(t){handleTransactionSuccess(t),services.push({text:"Updated maxStake to ".concat(i),hash:t})}).on("receipt",function(t){services.update(t)}).on("error",function(t,n){console.log("error :>> ",t),handleTransactionError(),n&&services.update(n)})):$(".admin-factory-msa-form__notice").html("Please enter the max stake amount."):$(".admin-factory-msa-form__notice").html("Please enter the pool id.")}function onRunFunction(){var t=window.variables,n=t.ACCOUNT,e=t.SHARD_CONTRACT,o=$(".admin-secondary-token-form__input-row[data-input='address']").find("input").val(),a=$("#admin-token-functions").val();if("renounceMinter"!==a&&"renounceCanTransfer"!==a){if(!o)return void $(".admin-secondary-token-form__notice").html("Please enter token address.");if(!toChecksumAddress(o))return void $(".admin-secondary-token-form__notice").html("Please enter valid token address.")}"renounceMinter"===a||"renounceCanTransfer"===a?send(e.methods[a])({from:n}).send().on("transactionHash",function(t){handleTransactionSuccess(t),services.push({text:"Run function ".concat(a),hash:t})}).on("receipt",function(t){services.update(t)}).on("error",function(t,n){console.log("error :>> ",t),handleTransactionError(),n&&services.update(n)}):send(e.methods[a])(o,{from:n}).send().on("transactionHash",function(t){handleTransactionSuccess(t),services.push({text:"Run function ".concat(a),hash:t})}).on("receipt",function(t){services.update(t)}).on("error",function(t,n){console.log("error :>> ",t),handleTransactionError(),n&&services.update(n)})}function clear(){$("#admin-token-token").val(""),$("#admin-factory-amount").val(""),$("#admin-factory-maxamount").val(""),$("#admin-factory-token").val("")}function toChecksumAddress(t){if(!web3)return t;try{return web3.utils.toChecksumAddress(t)}catch(t){return!1}}function handleTransactionSuccess(t){$(".popup-overlay#pending_supply").fadeOut(200),$(".popup-overlay#transaction_status").fadeIn(200),$(".popup-overlay .popup__transaction-title").text("Transaction Submitted"),$(".popup-overlay .popup__transaction-title").after('\n    <a\n      target="_blank"\n      rel="noopener noreferrer"\n      href="'.concat(netLink(t),'"\n      class="popup__transaction-link">\n      View on ').concat(netScan(),"\n    </a>\n  ")),$(".popup-overlay .popup__transaction-btn").text("Close"),clear()}function handleTransactionError(){$(".popup-overlay#pending_supply").fadeOut(200),$(".popup-overlay#transaction_status").fadeIn(200),$(".popup-overlay .popup__transaction-title").text("Transaction Rejected."),$(".popup-overlay .popup__transaction-btn").text("Dismiss")}function onModalClose(){$(".popup-overlay").fadeOut(200)}window.onload=function(){window.triggers.selectAccount=[].concat(_toConsumableArray(window.triggers.selectAccount||[]),["init"]),window.events.init=init,window.events.onModalClose=onModalClose,$("#admin-token-functions").on("change",function(t){var n=$(t.target).val();"renounceMinter"===n||"renounceCanTransfer"===n?($("#admin-factory-token").val(""),$("#admin-factory-token").attr("disabled",!0)):$("#admin-factory-token").removeAttr("disabled")})};