"use strict";function ownKeys(e,t){var n,a=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)),a}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach(function(t){_defineProperty(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],a=!0,o=!1,r=void 0;try{for(var s,i=t[Symbol.iterator]();!(a=(s=i.next()).done)&&(n.push(s.value),!e||n.length!==e);a=!0);}catch(t){o=!0,r=t}finally{try{a||null==i.return||i.return()}finally{if(o)throw r}}return n}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function renderPopup(){$("body").append('\n    <div class="popup-overlay" id="connect_wallet">\n      <div class="popup">\n        <div class="popup__close js-popup-close"></div>\n        <div class="popup__title">\n          <h6>Connect to a wallet</h6>\n        </div>\n        <div class="wallet-list" data-scroll-lock-scrollable >\n          <a href="#metamask" class="wallet-list__item js-popup-open">\n            <img src="images/metamask.svg" alt="" />\n            <span>MetaMask</span>\n          </a>\n          <a href="#walletconnet" class="wallet-list__item js-popup-open">\n            <img src="images/walletconnect.svg" alt="" />\n            <span>WalletConnect</span>\n          </a>\n        </div>\n        <div class="popup__about-wallets" >New to Ethereum?\n          <a href="#">Learn more about wallets</a>\n        </div>\n      </div>\n    </div>\n    <div class="popup-overlay" id="transactions" data-scroll-lock-scrollable>\n      <div class="popup popup--select-token">\n        <div class="popup__close js-popup-close"></div>\n        <div class="popup__title">\n          <h6>Transactions</h6>\n        </div>\n        <div class="transactions">\n          <div class="common-bases__title">\n            Recent transactions\n            <span id="clear-all" data-service-click="clear">(clear-all)</span>\n          </div>\n          <div class="transactions__description">Your transactions will appear here...</div>\n          <div class="transactions__items">\n            <a href="#" data-key="0x0000000000000000000000000000000000000000">\n              <span class="ticker">Waiting...</span>\n            </a>\n          </div>\n        </div>\n      </div>\n    </div>\n  ')}function renderForm(t){t.html('\n      <form class="stake-embed-form" action="#" data-submit="disabled">\n        <div class="stake-embed-form__title">\n          <h6>CONDUCTIVE - SWORD</h6>\n        </div>\n        <div class="stake-embed-form__subtitle">\n          <h6>Earn SHARD</h6>\n          <div class="stake-embed-form__subtitle--event"></div>\n        </div>\n        <div class="stake-embed-form__info">\n          <div class="stake-embed-form__info-earned"></div>\n          <div class="stake-embed-form__info-staked"></div>\n          <div class="stake-embed-form__info-balance"></div>\n          <div class="stake-embed-form__info-stakable"></div>\n        </div>\n        <div class="stake-embed-form__notice"></div>\n        <div class="stake-embed-form__inputs">\n          <div class="stake-embed-form__input">\n            <div class="stake-embed-form__input-header">\n              <div class="stake-embed-form__input-header-title">SHARD EARNED</div>\n            </div>\n            <div class="stake-embed-form__input-row stake-embed-form__earned" data-input="claim-amount">\n              <input id="stake-earned-amount" placeholder="0.00" data-event-input="onInputAmount:earnedAmount" disabled="">\n              <button class="btn btn-small btn-harvest" href="#" disabled="disabled">Claim</button>\n            </div>\n          </div>\n          <div class="stake-embed-form__input">\n            <div class="stake-embed-form__input-header">\n              <div class="stake-embed-form__input-header-title" id="stake-token-label">CONDUCTIVE - SWORD STAKED</div>\n            </div>\n            <div class="stake-embed-form__input-row stake-embed-form__max-stake" data-input="amount">\n              <input id="stake-amount" placeholder="0.00" data-event-input="onInputAmount:amount">\n              <button class="btn btn-max-amount" href="#">MAX</button>\n            </div>\n          </div>\n        </div>\n        <div class="btn-add-pool">\n          <button class="btn btn-big btn-approve-staking href="#">Approve Staking</button>\n          <button class="btn btn-big btn-approve-staking href="#stake_asset">Stake</button>\n          <button class="btn btn-big btn-approve-staking href="#unstake_asset">UnStake</button>\n        </div>\n      </form>\n  ')}function initFarm(){var t=window.variables,e=t.ACCOUNT,n=t.INIT,a=n?n.bgColor:null,o=n?n.buttonColor:null,r=(n&&n.buttonText,n?n.textColor:null),s=(n?n.title:null)||"CONDUCTIVE - SWORD";a&&$(".stake-embed-form").css("backgroundColor","#".concat(a)),$(".stake-embed-form__title h6").html(s),$("#stake-token-label").html("".concat(s," STAKED")),o&&$(".btn-harvest").css("backgroundColor","#".concat(o)),r&&($(".stake-embed-form__title h6").css("color","#".concat(r)),$(".stake-embed-form__subtitle").css("color","#".concat(r)),$(".stake-embed-form__info").css("color","#".concat(r)),$(".stake-embed-form__input-header div").css("color","#".concat(r))),$(".stake-embed-form__info").hide(),e&&updatePool()}function updatePool(){var t=window.variables,e=t.ACCOUNT,n=t.CONTRACT_ERC20_ABI,a=t.CONTRACT_FACTORY_ADDRESS,o=t.FACTORY_CONTRACT,r=t.INIT,s=r?r.token:"0x99BB38c25711ac1915FD0E9781ddBC421Fc0f625";toChecksumAddress(s)&&initData(function(t){var d,u=t.find(function(t){return toChecksumAddress(t.token)===toChecksumAddress(s)});u?(d=new web3.eth.Contract(n,toChecksumAddress(u.token)),Promise.all([Promise.resolve(u.token),call(d.methods.name)(),call(d.methods.decimals)(),call(d.methods.symbol)(),call(d.methods.balanceOf)(e),call(d.methods.allowance)(e,a),call(o.methods.pendingSecondaryToken)(u.id,e),getPoolUser(e)]).then(function(t){var e=_slicedToArray(t,8),n=e[0],a=e[1],o=e[2],r=e[3],s=e[4],i=e[5],l=e[6],c=e[7];window.variables.POOL=_objectSpread(_objectSpread({},u),{},{tokenAddress:n,tokenName:a,decimal:o,tokenSymbol:r,balance:web3.utils.fromWei(s,"ether"),allowance:Number(web3.utils.fromWei(i,"ether")),reward:Number(web3.utils.fromWei(l,"ether")),user:c,tokenContract:d}),checkValid()})):console.log("incorrect token address!!!!!")})}function initData(n){window.variables.FACTORY_CONTRACT&&Promise.all([getPools()]).then(function(t){var e=_slicedToArray(t,1)[0];n(e)}).catch(console.log)}function checkValid(){var t,e=$(".btn-add-pool"),n=window.variables,a=n.ACCOUNT,o=n.POOL,r=n.INIT,s=r?r.buttonColor:null;if($("#stake-earned-amount").val(o.reward),new BigNumber(o.balance).isZero()?($("#stake-amount").hide(),$(".btn-max-amount").hide()):($("#stake-amount").show(),$(".btn-max-amount").show()),new BigNumber(o.maxStake).isZero()?$(".stake-embed-form__title--event").text(""):$(".stake-embed-form__title--event").text("Event ended"),!a)return s?$(e).html('<button class="btn btn-big js-popup-open" href="#connect_wallet" style="background-color: #'.concat(s,'">Connect Wallet</button>')):$(e).html('<button class="btn btn-big js-popup-open" href="#connect_wallet">Connect Wallet</button>'),$(".btn-harvest").attr("disabled",!0),void $(".btn-harvest").css("backgroundColor","#dee2e6");$(".stake-embed-form__info").show(),$(".stake-embed-form__info-earned").html("<span>Current Earned : </span><span>".concat(o.reward," SHARD</span>")),$(".stake-embed-form__info-staked").html("<span>Current Staked : </span><span>".concat(new BigNumber(o.user[o.id].amount).div(new BigNumber(10).pow(o.decimal)).toString(10)," ").concat(o.tokenSymbol,"</span>")),$(".stake-embed-form__info-balance").html("<span>Current Balance : </span><span>".concat(new BigNumber(o.balance).dp(2,1).toString(10)," ").concat(o.tokenSymbol,"</span>"));var i,l,c,d,u,b=new BigNumber(o.maxStake).div(1e18),m=new BigNumber(o.user?((null===(t=o.user[o.id])||void 0===t?void 0:t.amount)||0)/1e18:0),p=b.minus(m);b.isZero()?$(".stake-embed-form__info-stakable").html("<span>Available Stake Amount : </span><span>".concat(m.dp(2,1).toString(10)," ").concat(o.tokenSymbol,"</span>")):(i=new BigNumber(o.balance)).gt(p)?$(".stake-embed-form__info-stakable").html("<span>Available Stake Amount : </span><span>".concat(p.dp(2,1).toString(10)," ").concat(o.tokenSymbol,"</span>")):$(".stake-embed-form__info-stakable").html("<span>Available Stake Amount : </span><span>".concat(i.dp(2,1).toString(10)," ").concat(o.tokenSymbol,"</span>")),o.reward?($(".btn-harvest").removeAttr("disabled"),s?$(".btn-harvest").css("backgroundColor","#".concat(s)):$(".btn-harvest").css("backgroundColor","")):($(".btn-harvest").attr("disabled",!0),$(".btn-harvest").css("backgroundColor","#dee2e6")),!o||o.allowance?new BigNumber(o.maxStake).isZero()?s?$(e).html('<button\n                            class="btn btn-big btn-unstaking"\n                            href="#unstake_asset"\n                            data-id="'.concat(o.id,'"\n                            data-address="').concat(o.token,'"\n                            data-name="').concat(o.tokenSymbol,'"\n                            data-type="unstake"\n                            data-amount="').concat(new BigNumber(null===(l=o.user[o.id])||void 0===l?void 0:l.amount).div(1e18).toString(10)||0,'"\n                            data-title="Withdraw"\n                            style="background-color: #').concat(s,'">UnStake and Claim</button>')):$(e).html('<button\n                            class="btn btn-big btn-unstaking"\n                            href="#unstake_asset"\n                            data-id="'.concat(o.id,'"\n                            data-address="').concat(o.token,'"\n                            data-name="').concat(o.tokenSymbol,'"\n                            data-type="unstake"\n                            data-amount="').concat(new BigNumber(null===(c=o.user[o.id])||void 0===c?void 0:c.amount).div(1e18).toString(10)||0,'"\n                            data-title="Withdraw">UnStake and Claim</button>')):s?$(e).html('<button\n                            class="btn btn-big btn-staking"\n                            href="#stake_asset"\n                            data-id="'.concat(o.id,'"\n                            data-address="').concat(o.token,'"\n                            data-name="').concat(o.tokenSymbol,'"\n                            data-type="stake"\n                            data-amount="').concat(o.balance,'"\n                            data-max-amount="').concat(o.maxStake,'"\n                            data-current-staked="').concat(new BigNumber(o.user?((null===(d=o.user[o.id])||void 0===d?void 0:d.amount)||0)/1e18:0),'"\n                            data-title="Deposit"\n                            style="background-color: #').concat(s,'">Stake</button>')):$(e).html('<button\n                            class="btn btn-big btn-staking"\n                            href="#stake_asset"\n                            data-id="'.concat(o.id,'"\n                            data-address="').concat(o.token,'"\n                            data-name="').concat(o.tokenSymbol,'"\n                            data-type="stake"\n                            data-amount="').concat(o.balance,'"\n                            data-max-amount="').concat(o.maxStake,'"\n                            data-current-staked="').concat(new BigNumber(o.user?((null===(u=o.user[o.id])||void 0===u?void 0:u.amount)||0)/1e18:0),'"\n                            data-title="Deposit">Stake</button>')):s?$(e).html('<button class="btn btn-big btn-approve-staking" href="#" data-name="'.concat(o.tokenSymbol,'" style="background-color: #').concat(s,'">Approve Staking</button>')):$(e).html('<button class="btn btn-big btn-approve-staking" href="#" data-name="'.concat(o.tokenSymbol,'">Approve Staking</button>'))}function approveStaking(e){var t=window.variables,n=t.ACCOUNT,a=t.CONTRACT_FACTORY_ADDRESS,o=t.POOL,r=o.LOADDING_APPROVE,s=o.tokenContract;n&&!r?(window.variables.POOL.LOADDING_APPROVE=1,$(".btn-approve-staking").attr("disabled",!0),$(".btn-approve-staking").html('<div class="btn-loader"></div>'),send(s.methods.approve)(a,new BigNumber(2).pow(256).minus(1).toString(10),{from:n}).send().on("transactionHash",function(t){window.variables.POOL.LOADDING_APPROVE=0,window.variables.POOL.allowance=1157920892373162e44,services.push({text:"Approve ".concat(e),hash:t}),checkValid()}).on("receipt",function(t){window.variables.POOL.LOADDING_APPROVE=0,services.update(t),$(".btn-approve-staking").removeAttr("disabled"),$(".btn-approve-staking").html("Approve Staking")}).on("error",function(t,e){window.variables.POOL.LOADDING_APPROVE=0,e&&services.update(e),$(".btn-approve-staking").removeAttr("disabled"),$(".btn-approve-staking").html("Approve Staking")})):console.log("choose account")}function harvestNow(t,n){$(".btn-harvest").attr("disabled",!0),$(".btn-harvest").html('<div class="btn-loader"></div>'),runHarvest([t,n],function(t,e){$(".btn-harvest").removeAttr("disabled"),$(".btn-harvest").html("Claim"),e?console.log(e):$(".stake-embed-form__notice").html("You're earning the ".concat(n," SHARD"))})}function clear(){}function toChecksumAddress(t){if(!web3)return t;try{return web3.utils.toChecksumAddress(t)}catch(t){return!1}}function handleTransactionSuccess(t){$(".popup-overlay#pending_supply").fadeOut(200),$(".popup-overlay#transaction_status").fadeIn(200),$(".popup-overlay .popup__transaction-title").text("Transaction Submitted"),$(".popup-overlay .popup__transaction-title").after('\n    <a\n      target="_blank"\n      rel="noopener noreferrer"\n      href="'.concat(netLink(t),'"\n      class="popup__transaction-link">\n      View on ').concat(netScan(),"\n    </a>\n  ")),$(".popup-overlay .popup__transaction-btn").text("Close"),clear()}function handleTransactionError(){$(".popup-overlay#pending_supply").fadeOut(200),$(".popup-overlay#transaction_status").fadeIn(200),$(".popup-overlay .popup__transaction-title").text("Transaction Rejected."),$(".popup-overlay .popup__transaction-btn").text("Dismiss")}function onModalClose(){$(".popup-overlay").fadeOut(200)}$(window).on("load",function(){renderPopup(),$(".stake-embed").length&&renderForm($(".stake-embed")),window.variables.POOL={LOADDING_APPROVE:0},window.triggers.selectAccount=[].concat(_toConsumableArray(window.triggers.selectAccount||[]),["init"]),window.events.init=initFarm,window.events.onModalClose=onModalClose,$(document).on("click",".btn-approve-staking",function(t){t.preventDefault(),approveStaking($(this).attr("data-name"))}),$(document).on("click",".btn-staking",function(t){t.preventDefault();var e,n=window.variables.POOL,a=$("#stake-amount").val(),o=new BigNumber(a),r=new BigNumber(n.maxStake),s=new BigNumber(n.balance);o.gt(new BigNumber(0))&&o.lte(s)&&o.lte(r)&&n.id?($(".stake-embed-form__notice").html(""),$(".btn-staking").attr("disabled",!0),$(".btn-staking").html('<div class="btn-loader"></div>'),runStake(n.id,o.toString(10),n.tokenSymbol,"stake",function(t,e){$(".btn-staking").removeAttr("disabled"),$(".btn-staking").html("Stake"),e&&console.log(e),updatePool()})):o.isZero()||!a?$(".stake-embed-form__notice").text("Please input your stake amount."):r.isZero()?$(".stake-embed-form__notice").text("Event ended. You cannot stake anymore."):o.gt(s)&&r.lte(s)?$(".stake-embed-form__notice").text("Exceed max stake amount. You can stake only ".concat(r.toString(10)," ").concat(n.tokenSymbol," now.")):o.gt(s)&&r.gt(s)?$(".stake-embed-form__notice").text("Exceed max stake amount. You can stake only ".concat(s.toString(10)," ").concat(n.tokenSymbol," now.")):$(".stake-embed-form__notice").text("Exceed max amount. You can stake only ".concat(r.minus(new BigNumber(n.user?((null===(e=n.user[n.id])||void 0===e?void 0:e.amount)||0)/1e18:0)).toString(10)," ").concat(n.tokenSymbol," now."))}),$(document).on("click",".btn-unstaking",function(t){t.preventDefault();var e,n=window.variables.POOL,a=$("#stake-amount").val(),o=new BigNumber(a),r=new BigNumber(n.balance);o.gt(new BigNumber(0))&&o.lte(r)&&pid&&"unstake"===type?runStake(n.id,o.toString(10),n.tokenSymbol,"stake",function(t,e){e&&console.log(e),updatePool()}):$(".stake-embed-form__notice").text("Exceed unstake amount. You can unstake only ".concat(maxAmount.minus(new BigNumber(n.user?((null===(e=n.user[n.id])||void 0===e?void 0:e.amount)||0)/1e18:0)).toString(10)," ").concat(n.tokenSymbol," now."))}),$(document).on("click",".btn-harvest",function(t){t.preventDefault();var e=window.variables.POOL,n=new BigNumber($("#stake-earned-amount").val());n.isZero()||n.isNaN()?$(".stake-embed-form__notice").text("Please input your claim amount."):harvestNow(e.id,n.toString(10))}),$(document).on("click",".btn-max-amount",function(t){var e;t.preventDefault();var n,a=window.variables.POOL,o=($(".btn-add-pool"),new BigNumber(a.maxStake).div(1e18)),r=new BigNumber(a.user?((null===(e=a.user[a.id])||void 0===e?void 0:e.amount)||0)/1e18:0),s=o.minus(r);new BigNumber(a.maxStake).isZero()?$("#stake-amount").val(r.dp(18,1).toString(10)):(n=new BigNumber(a.balance)).gt(s)?$("#stake-amount").val(s.dp(18,1).toString(10)):$("#stake-amount").val(n.dp(18,1).toString(10))}),checkValid()});